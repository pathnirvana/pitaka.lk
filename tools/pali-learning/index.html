<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pali Picture Dictionary</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@400;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #f39c12;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Poppins', 'Noto Sans Sinhala', sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* --- Header --- */
        header {
            text-align: center;
            margin-bottom: 20px;
            width: 100%;
            max-width: 1000px;
            z-index: 10;
        }

        h1 {
            color: var(--dark);
            margin-bottom: 10px;
            font-size: 1.8rem;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            background: white;
            padding: 10px 20px;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            width: fit-content;
            margin: 0 auto;
        }

        button {
            border: none;
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            font-family: inherit;
        }

        button:active { transform: scale(0.95); }

        .toggle-btn { background-color: var(--light); color: var(--dark); }
        .toggle-btn.active { background-color: var(--primary); color: white; }
        
        .action-btn { background-color: var(--dark); color: white; }
        .action-btn:hover { opacity: 0.9; }

        /* --- Grid/Card Container --- */
        .container-wrapper {
            position: relative;
            width: 100%;
            max-width: 1000px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 20px;
            width: 100%;
        }

        /* --- Card Styles --- */
        .card {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding-bottom: 15px;
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }

        .image-container {
            width: 100%;
            padding-top: 80%;
            position: relative;
            background-color: #fff;
            border-bottom: 2px solid #f0f0f0;
        }

        .sprite-img {
            position: absolute;
            top: 10px; left: 10px; right: 10px; bottom: 10px;
            /* Background Image is now set in JS */
            background-size: 500% 400%; 
            background-repeat: no-repeat;
        }

        .text-content {
            padding: 10px 10px;
            width: 100%;
            box-sizing: border-box;
            transition: opacity 0.3s;
        }

        .quiz-active .text-content { opacity: 0; filter: blur(5px); }
        .quiz-active .card:hover .text-content,
        .quiz-active .card:active .text-content { opacity: 1; filter: blur(0); }

        .pali-word { font-size: 1.4rem; font-weight: 700; color: #d35400; margin: 5px 0 2px 0; }
        .meaning { font-size: 1rem; color: #7f8c8d; font-weight: 600; }

        /* --- Mobile Navigation --- */
        .nav-arrow {
            display: none;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.9);
            color: var(--dark);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            font-size: 24px;
            z-index: 20;
            border: none;
            cursor: pointer;
            justify-content: center;
            align-items: center;
            -webkit-tap-highlight-color: transparent;
        }
        .nav-prev { left: 0; }
        .nav-next { right: 0; }

        /* --- Mobile Responsive Styles --- */
        @media (max-width: 768px) {
            body { padding: 10px; justify-content: start; }
            
            .grid-container {
                display: flex;
                justify-content: center;
                align-items: center;
                height: 60vh; 
            }

            .card {
                display: none; 
                width: 100%;
                max-width: 300px;
                height: auto;
                box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            }

            .card.active { display: flex; }
            .nav-arrow { display: flex; }
            .container-wrapper { padding: 0 60px; box-sizing: border-box; }
        }
    </style>
</head>
<body>

    <header>
        <h1>Pali Learner</h1>
        <div class="controls">
            <button class="toggle-btn active" id="btn-si" onclick="setLanguage('si')">üá±üá∞ Sinhala</button>
            <button class="toggle-btn" id="btn-en" onclick="setLanguage('en')">üá¨üáß English</button>
            <button class="action-btn" onclick="toggleQuiz()">üëÅÔ∏è Quiz</button>
            <button class="action-btn" onclick="shuffleCards()">üîÄ Shuffle</button>
        </div>
    </header>

    <div class="container-wrapper">
        <button class="nav-arrow nav-prev" onclick="navigate(-1)">&#10094;</button>
        <div class="grid-container" id="app"></div>
        <button class="nav-arrow nav-next" onclick="navigate(1)">&#10095;</button>
    </div>

    <script>
        // --- DATA SECTION ---
        
        // Words 1-20 (Sprite 1)
        const set1 = [
            { id: 1,  pali: "‡∂Ö‡∑É‡∑ä‡∑É", paliRom: "Assa",     si: "‡∂Ö‡∑Å‡∑ä‡∑Ä‡∂∫‡∑è",  en: "Horse",   row: 0, col: 0 },
            { id: 2,  pali: "‡∂ú‡∑è‡∂∏",  paliRom: "GƒÅma",     si: "‡∂ú‡∂∏",      en: "Village", row: 0, col: 1 },
            { id: 3,  pali: "‡∂ú‡∑ú‡∂´",  paliRom: "Go·πáa",     si: "‡∂ú‡∑ú‡∂±‡∑è",    en: "Bull",    row: 0, col: 2 },
            { id: 4,  pali: "‡∂ª‡∑î‡∂ö‡∑ä‡∂õ", paliRom: "Rukkha",   si: "‡∂ú‡∑É",      en: "Tree",    row: 0, col: 3 },
            { id: 5,  pali: "‡∑É‡∑î‡∂±‡∂õ", paliRom: "Sunakha",  si: "‡∂∂‡∂Ω‡∑ä‡∂Ω‡∑è",   en: "Dog",     row: 0, col: 4 },
            { id: 6,  pali: "‡∂†‡∂±‡∑ä‡∂Ø", paliRom: "Canda",    si: "‡∑Ñ‡∂≥",      en: "Moon",    row: 1, col: 0 },
            { id: 7,  pali: "‡∑É‡∑ì‡∑Ñ",  paliRom: "Sƒ´ha",     si: "‡∑É‡∑í‡∂Ç‡∑Ñ‡∂∫‡∑è",  en: "Lion",    row: 1, col: 1 },
            { id: 8,  pali: "‡∑É‡∑ñ‡∂ª‡∑í‡∂∫", paliRom: "S≈´riya",   si: "‡∑Ñ‡∑í‡∂ª‡∑î",     en: "Sun",     row: 1, col: 2 },
            { id: 9,  pali: "‡∂∏‡∑í‡∂ú",  paliRom: "Miga",     si: "‡∂∏‡∑î‡∑Ä‡∑è",    en: "Deer",    row: 1, col: 3 },
            { id: 10, pali: "‡∂¥‡∑è‡∑É‡∑è‡∂´", paliRom: "PƒÅsƒÅ·πáa",  si: "‡∂ú‡∂Ω",      en: "Rock",    row: 1, col: 4 },
            { id: 11, pali: "‡∂Ö‡∂¢",   paliRom: "Aja",      si: "‡∂ë‡∑Ö‡∑î‡∑Ä‡∑è",   en: "Goat",    row: 2, col: 0 },
            { id: 12, pali: "‡∂Ω‡∑ú‡∂ö",  paliRom: "Loka",     si: "‡∂Ω‡∑ú‡∑Ä",     en: "World",   row: 2, col: 1 },
            { id: 13, pali: "‡∑Ä‡∑è‡∂±‡∂ª", paliRom: "VƒÅnara",   si: "‡∑Ä‡∂≥‡∑î‡∂ª‡∑è",   en: "Monkey",  row: 2, col: 2 },
            { id: 14, pali: "‡∂Ü‡∂Ω‡∑ú‡∂ö", paliRom: "ƒÄloka",    si: "‡∂ë‡∑Ö‡∑í‡∂∫",    en: "Light",   row: 2, col: 3 },
            { id: 15, pali: "‡∑É‡∂ö‡∑î‡∂´", paliRom: "Saku·πáa",   si: "‡∂¥‡∂ö‡∑ä‚Äç‡∑Ç‡∑í‡∂∫‡∑è", en: "Bird",    row: 2, col: 4 },
            { id: 16, pali: "‡∂∏‡∂§‡∑ä‡∂†", paliRom: "Ma√±ca",    si: "‡∂á‡∂≥",      en: "Bed",     row: 3, col: 0 },
            { id: 17, pali: "‡∂ö‡∑è‡∂ö",  paliRom: "KƒÅka",     si: "‡∂ö‡∑è‡∂ö‡∑ä‡∂ö‡∑è",  en: "Crow",    row: 3, col: 1 },
            { id: 18, pali: "‡∂Ü‡∂ö‡∑è‡∑É", paliRom: "ƒÄkƒÅsa",    si: "‡∂Ö‡∑Ñ‡∑É",     en: "Sky",     row: 3, col: 2 },
            { id: 19, pali: "‡∑Ä‡∂ª‡∑è‡∑Ñ", paliRom: "VarƒÅha",   si: "‡∂å‡∂ª‡∑è",     en: "Pig",     row: 3, col: 3 },
            { id: 20, pali: "‡∂∏‡∂ú‡∑ä‡∂ú", paliRom: "Magga",    si: "‡∂∏‡∑è‡∂ª‡∑ä‡∂ú‡∂∫",  en: "Road",    row: 3, col: 4 }
        ];

        // Words 21-40 (Sprite 2)
        const set2 = [
            { id: 21, pali: "‡∂∂‡∑î‡∂Ø‡∑ä‡∂∞",    paliRom: "Buddha",    si: "‡∂∂‡∑î‡∂Ø‡∑î‡∂ª‡∂¢",       en: "The Buddha",   row: 0, col: 0 },
            { id: 22, pali: "‡∂∞‡∂∏‡∑ä‡∂∏",     paliRom: "Dhamma",    si: "‡∂∞‡∂ª‡∑ä‡∂∏‡∂∫",       en: "Doctrine",     row: 0, col: 1 },
            { id: 23, pali: "‡∑É‡∂Ç‡∂ù",      paliRom: "Sa·πÖgha",    si: "‡∑É‡∂Ç‡∂ù‡∂∫‡∑è",       en: "Monk",         row: 0, col: 2 },
            { id: 24, pali: "‡∂∏‡∂±‡∑î‡∑É‡∑ä‡∑É",   paliRom: "Manussa",   si: "‡∂∏‡∑í‡∂±‡∑í‡∑É‡∑è",       en: "Man",          row: 0, col: 3 },
            { id: 25, pali: "‡∂Ø‡∑ô‡∑Ä",      paliRom: "Deva",      si: "‡∂Ø‡∑ô‡∑Ä‡∑í‡∂∫‡∑è",       en: "Deity",        row: 0, col: 4 },
            { id: 26, pali: "‡∑Ä‡∑è‡∂´‡∑í‡∂¢",    paliRom: "VƒÅ·πáija",    si: "‡∑Ä‡∑ô‡∑Ö‡∑ô‡∂±‡∑ä‡∂Ø‡∑è",     en: "Merchant",     row: 1, col: 0 },
            { id: 27, pali: "‡∂Ω‡∑ô‡∂õ‡∂ö",     paliRom: "Lekhaka",   si: "‡∂Ω‡∑í‡∂∫‡∂±‡∑ä‡∂±‡∑è",      en: "Writer",       row: 1, col: 1 },
            { id: 28, pali: "‡∂†‡∑ú‡∂ª",      paliRom: "Cora",      si: "‡∑É‡∑ú‡∂ª‡∑è",        en: "Thief",        row: 1, col: 2 },
            { id: 29, pali: "‡∂∏‡∑í‡∂≠‡∑ä‡∂≠",    paliRom: "Mitta",     si: "‡∂∏‡∑í‡∂≠‡∑î‡∂ª‡∑è",       en: "Friend",       row: 1, col: 3 },
            { id: 30, pali: "‡∂∑‡∑ñ‡∂¥‡∑è‡∂Ω",    paliRom: "Bh≈´pƒÅla",   si: "‡∂ª‡∂¢",          en: "King",         row: 1, col: 4 },
            { id: 31, pali: "‡∂ö‡∑É‡∑ä‡∑É‡∂ö",    paliRom: "Kassaka",   si: "‡∂ú‡∑ú‡∑Ä‡∑í‡∂∫‡∑è",       en: "Farmer",       row: 2, col: 0 },
            { id: 32, pali: "‡∂ö‡∂∏‡∑ä‡∂∏‡∂ö‡∑è‡∂ª",  paliRom: "KammakƒÅra", si: "‡∂ö‡∂∏‡∑ä‡∂ö‡∂ª‡∑î‡∑Ä‡∑è",     en: "Worker",       row: 2, col: 1 },
            { id: 33, pali: "‡∂ú‡∑ú‡∂¥‡∑è‡∂Ω",    paliRom: "GopƒÅla",    si: "‡∂ú‡∑ú‡∂¥‡∂Ω‡∑ä‡∂Ω‡∑è",      en: "Cowherd",      row: 2, col: 2 },
            { id: 34, pali: "‡∂ª‡∂¢‡∂ö",      paliRom: "Rajaka",    si: "‡∂ª‡∑ô‡∂Ø‡∑í‡∑É‡∑ù‡∂Ø‡∂±‡∑ä‡∂±‡∑è",   en: "Washerman",    row: 2, col: 3 },
            { id: 35, pali: "‡∂Ø‡∑è‡∑É",      paliRom: "DƒÅsa",      si: "‡∂Ø‡∑è‡∑É‡∂∫‡∑è",        en: "Servant",      row: 2, col: 4 },
            { id: 36, pali: "‡∂¥‡∑î‡∂≠‡∑ä‡∂≠",    paliRom: "Putta",     si: "‡∂¥‡∑î‡∂≠‡∑ä‚Äç‡∂ª‚Äç‡∂∫‡∑è",       en: "Son",          row: 3, col: 0 },
            { id: 37, pali: "‡∂ö‡∑î‡∂∏‡∑è‡∂ª",    paliRom: "KumƒÅra",    si: "‡∂ö‡∑î‡∂∏‡∂ª‡∑è (‡∑Ö‡∂∏‡∂∫‡∑è)", en: "Prince/Boy",   row: 3, col: 1 },
            { id: 38, pali: "‡∑Ñ‡∂≠‡∑ä‡∂Æ",     paliRom: "Hattha",    si: "‡∂Ö‡∂≠",          en: "Hand",         row: 3, col: 2 },
            { id: 39, pali: "‡∂¥‡∑è‡∂Ø",      paliRom: "PƒÅda",      si: "‡∂¥‡∂∫",          en: "Foot",         row: 3, col: 3 },
            { id: 40, pali: "‡∂ö‡∑è‡∂∫",      paliRom: "KƒÅya",      si: "‡∂ö‡∂∫ (‡∑É‡∑í‡∂ª‡∑î‡∂ª)",   en: "Body",         row: 3, col: 4 }
        ];

        // MERGE LISTS
        const initialWords = [...set1, ...set2];

        // --- APP LOGIC ---

        let words = [...initialWords];
        let currentLang = 'si';
        let quizMode = false;
        let activeIndex = 0;

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSwipeSound() {
            if (audioCtx.state === 'suspended') { audioCtx.resume(); }
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(300, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.15);
            gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.15);
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.15);
        }

        function renderCards() {
            const container = document.getElementById('app');
            container.innerHTML = '';

            words.forEach((word, index) => {
                const paliText = currentLang === 'si' ? word.pali : word.paliRom;
                const meaningText = currentLang === 'si' ? word.si : word.en;
                
                // Sprite Positioning Logic
                const posX = (word.col / 4) * 100;
                const posY = (word.row / 3) * 100;

                // --- NEW: Select correct image based on ID ---
                // IDs 1-20 use the first image, IDs 21+ use the second
                const imageSource = word.id <= 20 ? 'pali-sprite.jpeg' : 'pali-sprite-2.jpeg';

                const activeClass = index === activeIndex ? 'active' : '';

                const cardHTML = `
                    <div class="card ${activeClass}" id="card-${index}">
                        <div class="image-container">
                            <!-- We set the background-image dynamically here -->
                            <div class="sprite-img" 
                                 style="background-image: url('${imageSource}'); 
                                        background-position: ${posX}% ${posY}%;">
                            </div>
                        </div>
                        <div class="text-content">
                            <div class="pali-word">${paliText}</div>
                            <div class="meaning">${meaningText}</div>
                        </div>
                    </div>
                `;
                container.innerHTML += cardHTML;
            });

            updateQuizMode();
        }

        function setLanguage(lang) {
            currentLang = lang;
            document.getElementById('btn-si').classList.toggle('active', lang === 'si');
            document.getElementById('btn-en').classList.toggle('active', lang === 'en');
            renderCards();
        }

        function toggleQuiz() {
            quizMode = !quizMode;
            updateQuizMode();
        }

        function updateQuizMode() {
            const container = document.getElementById('app');
            if(quizMode) {
                container.classList.add('quiz-active');
            } else {
                container.classList.remove('quiz-active');
            }
        }

        function shuffleCards() {
            for (let i = words.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [words[i], words[j]] = [words[j], words[i]];
            }
            activeIndex = 0;
            renderCards();
        }

        function navigate(direction) {
            playSwipeSound();
            document.getElementById(`card-${activeIndex}`).classList.remove('active');
            activeIndex += direction;
            if (activeIndex < 0) activeIndex = words.length - 1;
            if (activeIndex >= words.length) activeIndex = 0;
            document.getElementById(`card-${activeIndex}`).classList.add('active');
        }

        // Initialize
        renderCards();

    </script>
</body>
</html>